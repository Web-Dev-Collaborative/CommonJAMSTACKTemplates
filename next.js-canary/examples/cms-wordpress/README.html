<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <title>README</title>
    <style type="text/css">
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
      div.column {
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
    </style>
    <style type="text/css">
      a.sourceLine {
        display: inline-block;
        line-height: 1.25;
      }
      a.sourceLine {
        pointer-events: none;
        color: inherit;
        text-decoration: inherit;
      }
      a.sourceLine:empty {
        height: 1.2em;
      }
      .sourceCode {
        overflow: visible;
      }
      code.sourceCode {
        white-space: pre;
        position: relative;
      }
      div.sourceCode {
        margin: 1em 0;
      }
      pre.sourceCode {
        margin: 0;
      }
      @media screen {
        div.sourceCode {
          overflow: auto;
        }
      }
      @media print {
        code.sourceCode {
          white-space: pre-wrap;
        }
        a.sourceLine {
          text-indent: -1em;
          padding-left: 1em;
        }
      }
      pre.numberSource a.sourceLine {
        position: relative;
        left: -4em;
      }
      pre.numberSource a.sourceLine::before {
        content: attr(title);
        position: relative;
        left: -1em;
        text-align: right;
        vertical-align: baseline;
        border: none;
        pointer-events: all;
        display: inline-block;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        padding: 0 4px;
        width: 4em;
        color: #aaaaaa;
      }
      pre.numberSource {
        margin-left: 3em;
        border-left: 1px solid #aaaaaa;
        padding-left: 4px;
      }
      div.sourceCode {
      }
      @media screen {
        a.sourceLine::before {
          text-decoration: underline;
        }
      }
      code span.al {
        color: #ff0000;
        font-weight: bold;
      } /* Alert */
      code span.an {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Annotation */
      code span.at {
        color: #7d9029;
      } /* Attribute */
      code span.bn {
        color: #40a070;
      } /* BaseN */
      code span.bu {
      } /* BuiltIn */
      code span.cf {
        color: #007020;
        font-weight: bold;
      } /* ControlFlow */
      code span.ch {
        color: #4070a0;
      } /* Char */
      code span.cn {
        color: #880000;
      } /* Constant */
      code span.co {
        color: #60a0b0;
        font-style: italic;
      } /* Comment */
      code span.cv {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* CommentVar */
      code span.do {
        color: #ba2121;
        font-style: italic;
      } /* Documentation */
      code span.dt {
        color: #902000;
      } /* DataType */
      code span.dv {
        color: #40a070;
      } /* DecVal */
      code span.er {
        color: #ff0000;
        font-weight: bold;
      } /* Error */
      code span.ex {
      } /* Extension */
      code span.fl {
        color: #40a070;
      } /* Float */
      code span.fu {
        color: #06287e;
      } /* Function */
      code span.im {
      } /* Import */
      code span.in {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Information */
      code span.kw {
        color: #007020;
        font-weight: bold;
      } /* Keyword */
      code span.op {
        color: #666666;
      } /* Operator */
      code span.ot {
        color: #007020;
      } /* Other */
      code span.pp {
        color: #bc7a00;
      } /* Preprocessor */
      code span.sc {
        color: #4070a0;
      } /* SpecialChar */
      code span.ss {
        color: #bb6688;
      } /* SpecialString */
      code span.st {
        color: #4070a0;
      } /* String */
      code span.va {
        color: #19177c;
      } /* Variable */
      code span.vs {
        color: #4070a0;
      } /* VerbatimString */
      code span.wa {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Warning */
    </style>
  </head>
  <body>
    <h1 id="a-statically-generated-blog-example-using-next.js-and-wordpress">
      A statically generated blog example using Next.js and WordPress
    </h1>
    <p>
      This example showcases Next.js’s
      <a href="https://nextjs.org/docs/basic-features/pages"
        >Static Generation</a
      >
      feature using <a href="https://wordpress.org">WordPress</a> as the data
      source.
    </p>
    <h2 id="demo">Demo</h2>
    <h3 id="httpsnext-blog-wordpress.vercel.app">
      <a href="https://next-blog-wordpress.vercel.app"
        >https://next-blog-wordpress.vercel.app</a
      >
    </h3>
    <h2 id="deploy-your-own">Deploy your own</h2>
    <p>
      Once you have access to
      <a href="#step-3-set-up-environment-variables"
        >the environment variables you’ll need</a
      >, deploy the example using
      <a
        href="https://vercel.com?utm_source=github&amp;utm_medium=readme&amp;utm_campaign=next-example"
        >Vercel</a
      >:
    </p>
    <p>
      <a
        href="https://vercel.com/new/git/external?repository-url=https://github.com/vercel/next.js/tree/canary/examples/cms-wordpress&amp;project-name=cms-wordpress&amp;repository-name=cms-wordpress&amp;env=WORDPRESS_API_URL&amp;envDescription=Required%20to%20connect%20the%20app%20with%20WordPress&amp;envLink=https://vercel.link/cms-wordpress-env"
        ><img src="https://vercel.com/button" alt="Deploy with Vercel"
      /></a>
    </p>
    <h3 id="related-examples">Related examples</h3>
    <ul>
      <li><a href="/examples/cms-datocms">DatoCMS</a></li>
      <li><a href="/examples/cms-sanity">Sanity</a></li>
      <li><a href="/examples/cms-takeshape">TakeShape</a></li>
      <li><a href="/examples/cms-prismic">Prismic</a></li>
      <li><a href="/examples/cms-contentful">Contentful</a></li>
      <li><a href="/examples/cms-strapi">Strapi</a></li>
      <li><a href="/examples/cms-agilitycms">Agility CMS</a></li>
      <li><a href="/examples/cms-cosmic">Cosmic</a></li>
      <li><a href="/examples/cms-buttercms">ButterCMS</a></li>
      <li><a href="/examples/cms-storyblok">Storyblok</a></li>
      <li><a href="/examples/cms-graphcms">GraphCMS</a></li>
      <li><a href="/examples/cms-kontent">Kontent</a></li>
      <li><a href="/examples/cms-ghost">Ghost</a></li>
      <li><a href="/examples/blog-starter">Blog Starter</a></li>
    </ul>
    <h2 id="how-to-use">How to use</h2>
    <p>
      Execute
      <a
        href="https://github.com/vercel/next.js/tree/canary/packages/create-next-app"
        ><code>create-next-app</code></a
      >
      with <a href="https://docs.npmjs.com/cli/init">npm</a> or
      <a href="https://yarnpkg.com/lang/en/docs/cli/create/">Yarn</a> to
      bootstrap the example:
    </p>
    <div class="sourceCode" id="cb1">
      <pre
        class="sourceCode bash"
      ><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">npx</span> create-next-app --example cms-wordpress cms-wordpress-app</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># or</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="ex">yarn</span> create next-app --example cms-wordpress cms-wordpress-app</a></code></pre>
    </div>
    <h2 id="configuration">Configuration</h2>
    <h3 id="step-1.-prepare-your-wordpress-site">
      Step 1. Prepare your WordPress site
    </h3>
    <p>
      First, you need a WordPress site. There are many solutions for WordPress
      hosting, such as <a href="https://wpengine.com/">WP Engine</a> and
      <a href="https://wordpress.com/">WordPress.com</a>.
    </p>
    <p>
      Once the site is ready, you’ll need to install the
      <a href="https://www.wpgraphql.com/">WPGraphQL</a> plugin. It will add
      GraphQL API to your WordPress site, which we’ll use to query the posts.
      Follow these steps to install it:
    </p>
    <ul>
      <li>
        Download the
        <a href="https://github.com/wp-graphql/wp-graphql">WPGraphQL repo</a> as
        a ZIP archive.
      </li>
      <li>
        Inside your WordPress admin, go to <strong>Plugins</strong> and then
        click <strong>Add New</strong>.
      </li>
    </ul>
    <figure>
      <img src="./docs/plugins-add-new.png" alt="Add new plugin" />
      <figcaption>Add new plugin</figcaption>
    </figure>
    <ul>
      <li>
        Click the <strong>Upload Plugin</strong> button at the top of the page
        and upload the WPGraphQL plugin.
      </li>
    </ul>
    <figure>
      <img src="./docs/plugins-upload-new.png" alt="Upload new plugin" />
      <figcaption>Upload new plugin</figcaption>
    </figure>
    <ul>
      <li>
        Once the plugin has been added, activate it from either the
        <strong>Activate Plugin</strong> button displayed after uploading or
        from the <strong>Plugins</strong> page.
      </li>
    </ul>
    <figure>
      <img src="./docs/plugin-installed.png" alt="WPGraphQL installed" />
      <figcaption>WPGraphQL installed</figcaption>
    </figure>
    <h4 id="optional-add-wpgraphiql">Optional: Add WPGraphiQL</h4>
    <p>
      The
      <a href="https://github.com/wp-graphql/wp-graphiql">WPGraphiQL</a> plugin
      gives you access to a GraphQL IDE directly from your WordPress Admin,
      allowing you to inspect and play around with the GraphQL API.
    </p>
    <p>
      The process to add WPGraphiQL is the same as the one for WPGraphQL: Go to
      the
      <a href="https://github.com/wp-graphql/wp-graphiql">WPGraphiQL repo</a>,
      download the ZIP archive, and install it as a plugin in your WordPress
      site. Once that’s done you should be able to access the GraphiQL page in
      the admin:
    </p>
    <figure>
      <img src="./docs/wp-graphiql.png" alt="WPGraphiQL page" />
      <figcaption>WPGraphiQL page</figcaption>
    </figure>
    <h3 id="step-2.-populate-content">Step 2. Populate Content</h3>
    <p>
      Inside your WordPress admin, go to <strong>Posts</strong> and start adding
      new posts:
    </p>
    <ul>
      <li>We recommend creating at least <strong>2 posts</strong></li>
      <li>Use dummy data for the content</li>
      <li>Pick an author from your WordPress users</li>
      <li>
        Add a <strong>Featured Image</strong>. You can download one from
        <a href="https://unsplash.com/">Unsplash</a>
      </li>
      <li>Fill the <strong>Excerpt</strong> field</li>
    </ul>
    <figure>
      <img src="./docs/new-post.png" alt="New post" />
      <figcaption>New post</figcaption>
    </figure>
    <p>When you’re done, make sure to <strong>Publish</strong> the posts.</p>
    <blockquote>
      <p>
        <strong>Note:</strong> Only <strong>published</strong> posts and public
        fields will be rendered by the app unless
        <a href="https://nextjs.org/docs/advanced-features/preview-mode"
          >Preview Mode</a
        >
        is enabled.
      </p>
    </blockquote>
    <h3 id="step-3.-set-up-environment-variables">
      Step 3. Set up environment variables
    </h3>
    <p>
      Copy the <code>.env.local.example</code> file in this directory to
      <code>.env.local</code> (which will be ignored by Git):
    </p>
    <div class="sourceCode" id="cb2">
      <pre
        class="sourceCode bash"
      ><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1"><span class="fu">cp</span> .env.local.example .env.local</a></code></pre>
    </div>
    <p>
      Then open <code>.env.local</code> and set
      <code>WORDPRESS_API_URL</code> to be the URL to your GraphQL endpoint in
      WordPress. For example: <code>https://myapp.wpengine.com/graphql</code>.
    </p>
    <p>Your <code>.env.local</code> file should look like this:</p>
    <div class="sourceCode" id="cb3">
      <pre
        class="sourceCode bash"
      ><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1"><span class="va">WORDPRESS_API_URL=</span>...</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co"># Only required if you want to enable preview mode</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co"># WORDPRESS_AUTH_REFRESH_TOKEN=</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co"># WORDPRESS_PREVIEW_SECRET=</span></a></code></pre>
    </div>
    <h3 id="step-4.-run-next.js-in-development-mode">
      Step 4. Run Next.js in development mode
    </h3>
    <div class="sourceCode" id="cb4">
      <pre
        class="sourceCode bash"
      ><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1"><span class="ex">npm</span> install</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="ex">npm</span> run dev</a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co"># or</span></a>
<a class="sourceLine" id="cb4-5" title="5"></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="ex">yarn</span> install</a>
<a class="sourceLine" id="cb4-7" title="7"><span class="ex">yarn</span> dev</a></code></pre>
    </div>
    <p>
      Your blog should be up and running on
      <a href="http://localhost:3000">http://localhost:3000</a>! If it doesn’t
      work, post on
      <a href="https://github.com/vercel/next.js/discussions"
        >GitHub discussions</a
      >.
    </p>
    <h3 id="step-5.-add-authentication-for-preview-mode-optional">
      Step 5. Add authentication for Preview Mode (Optional)
    </h3>
    <p>
      <strong>This step is optional.</strong> By default, the blog will work
      with public posts from your WordPress site. Private content such as
      unpublished posts and private fields cannot be retrieved. To have access
      to unpublished posts you’ll need to set up authentication.
    </p>
    <p>
      To add
      <a
        href="https://docs.wpgraphql.com/guides/authentication-and-authorization/"
        >authentication to WPGraphQL</a
      >, first you need to add the
      <a href="https://github.com/wp-graphql/wp-graphql-jwt-authentication"
        >WPGraphQL JWT plugin</a
      >
      to your WordPress Admin following the same process you used to add the
      WPGraphQL plugin.
    </p>
    <blockquote>
      <p>
        Adding the WPGraphQL JWT plugin will disable your GraphQL API until you
        add a JWT secret (<a
          href="https://github.com/wp-graphql/wp-graphql-jwt-authentication/issues/91"
          >GitHub issue</a
        >).
      </p>
    </blockquote>
    <p>
      Once that’s done, you’ll need to access the WordPress filesystem to add
      the secret required to validate JWT tokens. We recommend using SFTP — the
      instructions vary depending on your hosting provider. For example:
    </p>
    <ul>
      <li>
        <a href="https://wpengine.com/support/sftp/"
          >SFTP guide for WP Engine</a
        >
      </li>
      <li>
        <a href="https://wordpress.com/support/sftp/"
          >SFTP guide for WordPress.com</a
        >
      </li>
    </ul>
    <p>
      Once you have SFTP access, open <code>wp-config.php</code> and add a
      secret for your JWT:
    </p>
    <div class="sourceCode" id="cb5">
      <pre
        class="sourceCode php"
      ><code class="sourceCode php"><a class="sourceLine" id="cb5-1" title="1"><span class="fu">define</span><span class="ot">(</span> <span class="st">&#39;GRAPHQL_JWT_AUTH_SECRET_KEY&#39;</span><span class="ot">,</span> <span class="st">&#39;YOUR_STRONG_SECRET&#39;</span> <span class="ot">);</span></a></code></pre>
    </div>
    <blockquote>
      <p>
        You can read more about this in the documentation for
        <a
          href="https://docs.wpgraphql.com/extensions/wpgraphql-jwt-authentication/"
          >WPGraphQL JWT Authentication</a
        >.
      </p>
    </blockquote>
    <p>
      Now, you need to get a <strong>refresh token</strong> to make
      authenticated requests with GraphQL. Make the following GraphQL mutation
      to your WordPress site from the GraphQL IDE (See notes about WPGraphiQL
      from earlier). Replace <code>your_username</code> with the
      <strong>username</strong> of a user with the
      <code>Administrator</code> role, and <code>your_password</code> with the
      user’s password.
    </p>
    <pre class="graphql"><code>mutation Login {
  login(
    input: {
      clientMutationId: &quot;uniqueId&quot;
      password: &quot;your_password&quot;
      username: &quot;your_username&quot;
    }
  ) {
    refreshToken
  }
}</code></pre>
    <p>
      Copy the <code>refreshToken</code> returned by the mutation, then open
      <code>.env.local</code>, and make the following changes:
    </p>
    <ul>
      <li>
        Uncomment <code>WORDPRESS_AUTH_REFRESH_TOKEN</code> and set it to be the
        <code>refreshToken</code> you just received.
      </li>
      <li>
        Uncomment <code>WORDPRESS_PREVIEW_SECRET</code> and set it to be any
        random string (ideally URL friendly).
      </li>
    </ul>
    <p>Your <code>.env.local</code> file should look like this:</p>
    <div class="sourceCode" id="cb7">
      <pre
        class="sourceCode bash"
      ><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" title="1"><span class="va">WORDPRESS_API_URL=</span>...</a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co"># Only required if you want to enable preview mode</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="va">WORDPRESS_AUTH_REFRESH_TOKEN=</span>...</a>
<a class="sourceLine" id="cb7-5" title="5"><span class="va">WORDPRESS_PREVIEW_SECRET=</span>...</a></code></pre>
    </div>
    <p>
      <strong>Important:</strong> Restart your Next.js server to update the
      environment variables.
    </p>
    <h3 id="step-6.-try-preview-mode">Step 6. Try preview mode</h3>
    <p>
      On your WordPress admin, create a new post like before, but
      <strong>do not publish</strong> it.
    </p>
    <p>
      Now, if you go to <code>http://localhost:3000</code>, you won’t see the
      post. However, if you enable <strong>Preview Mode</strong>, you’ll be able
      to see the change (<a
        href="https://nextjs.org/docs/advanced-features/preview-mode"
        >Documentation</a
      >).
    </p>
    <p>To enable Preview Mode, go to this URL:</p>
    <pre><code>http://localhost:3000/api/preview?secret=&lt;secret&gt;&amp;id=&lt;id&gt;</code></pre>
    <ul>
      <li>
        <code>&lt;secret&gt;</code> should be the string you entered for
        <code>WORDPRESS_PREVIEW_SECRET</code>.
      </li>
      <li>
        <code>&lt;id&gt;</code> should be the post’s
        <code>databaseId</code> field, which is the integer that you usually see
        in the URL (<code>?post=18</code> → 18).
      </li>
      <li>
        Alternatively, you can use <code>&lt;slug&gt;</code> instead of
        <code>&lt;id&gt;</code>. <code>&lt;slug&gt;</code> is generated based on
        the title.
      </li>
    </ul>
    <p>
      You should now be able to see this post. To exit Preview Mode, you can
      click on <strong>Click here to exit preview mode</strong> at the top.
    </p>
    <h3 id="step-7.-deploy-on-vercel">Step 7. Deploy on Vercel</h3>
    <p>
      You can deploy this app to the cloud with
      <a
        href="https://vercel.com?utm_source=github&amp;utm_medium=readme&amp;utm_campaign=next-example"
        >Vercel</a
      >
      (<a href="https://nextjs.org/docs/deployment">Documentation</a>).
    </p>
    <h4 id="deploy-your-local-project">Deploy Your Local Project</h4>
    <p>
      To deploy your local project to Vercel, push it to GitHub/GitLab/Bitbucket
      and
      <a
        href="https://vercel.com/new?utm_source=github&amp;utm_medium=readme&amp;utm_campaign=next-example"
        >import to Vercel</a
      >.
    </p>
    <p>
      <strong>Important</strong>: When you import your project on Vercel, make
      sure to click on <strong>Environment Variables</strong> and set them to
      match your <code>.env.local</code> file.
    </p>
    <h4 id="deploy-from-our-template">Deploy from Our Template</h4>
    <p>
      Alternatively, you can deploy using our template by clicking on the Deploy
      button below.
    </p>
    <p>
      <a
        href="https://vercel.com/new/git/external?repository-url=https://github.com/vercel/next.js/tree/canary/examples/cms-wordpress&amp;project-name=cms-wordpress&amp;repository-name=cms-wordpress&amp;env=WORDPRESS_API_URL&amp;envDescription=Required%20to%20connect%20the%20app%20with%20WordPress&amp;envLink=https://vercel.link/cms-wordpress-env"
        ><img src="https://vercel.com/button" alt="Deploy with Vercel"
      /></a>
    </p>
  </body>
</html>
